
(defpoll media_info :interval "2s" "scripts/spotify_data.sh")

(defwidget media_player []
  (box
    :class "media-box"
    :orientation "horizontal"
    :spacing 10
    :space-evenly false
    (image :class "media-cover" :path cover :image-width "64px" :image-height "64px")
    (box :orientation "vertical" :space-evenly false :spacing 4
      (label :class "media-title" :text title_parsed)
      (label :class "media-artist" :text artist_parsed)
      (box :orientation "horizontal" :space-evenly false :spacing 6
        (button :onclick "playerctl previous" :label "⏮")
        (button :onclick "playerctl play-pause" :label "⏯")
        (button :onclick "playerctl next" :label "⏭"))
      (box :orientation "horizontal" :space-evenly false :spacing 6
        (label :text position)
        (progress :value position :max length :class "media-progress")
        (label :text length)))))

  (defwindow media_player
    :geometry (geometry
                :x "20px"
                :y "60px"
                :width "400px"
                :height "100px"
                :anchor "top right")
    :stacking "top"
    :windowtype "dock"
    :layer "top"
    :exclusive false
    :focusable false
    (media_player))

  (defvar cover "images/music.png")
  (defvar artist_parsed "No artist")
  (defvar title_parsed "No title")
  (defvar position 0)
  (defvar length 100)
  (deflisten media_data "scripts/spotify_data.sh")
